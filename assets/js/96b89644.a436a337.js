"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[689],{28453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>o});var r=i(96540);const s={},t=r.createContext(s);function c(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(t.Provider,{value:n},e.children)}},76766:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"sync","title":"Sync Service Configuration","description":"The ServiceRadar Sync service integrates external data sources with ServiceRadar\'s monitoring capabilities. It works with the KV Store to automatically synchronize device information from external systems and generate appropriate monitoring configurations. This allows for automatic discovery and monitoring of devices from systems like NetBox, Armis, and other inventory or security platforms.","source":"@site/docs/sync.md","sourceDirName":".","slug":"/sync","permalink":"/docs/sync","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9,"title":"Sync Service Configuration"},"sidebar":"tutorialSidebar","previous":{"title":"KV Store Configuration","permalink":"/docs/kv-configuration"},"next":{"title":"Authentication Configuration","permalink":"/docs/auth-configuration"}}');var s=i(74848),t=i(28453);const c={sidebar_position:9,title:"Sync Service Configuration"},o="Sync Service Configuration",d={},l=[{value:"Overview",id:"overview",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Configuration Options",id:"configuration-options",level:3},{value:"Source Configuration",id:"source-configuration",level:3},{value:"Supported Integrations",id:"supported-integrations",level:2},{value:"NetBox Integration",id:"netbox-integration",level:3},{value:"NetBox-Specific Options",id:"netbox-specific-options",level:4},{value:"Armis Integration",id:"armis-integration",level:3},{value:"Armis-Specific Options",id:"armis-specific-options",level:4},{value:"Security Requirements",id:"security-requirements",level:2},{value:"mTLS Configuration",id:"mtls-configuration",level:3},{value:"KV Store RBAC Configuration",id:"kv-store-rbac-configuration",level:3},{value:"Agent Configuration for KV",id:"agent-configuration-for-kv",level:2},{value:"Generated Configurations",id:"generated-configurations",level:2},{value:"Network Sweep Configuration Example",id:"network-sweep-configuration-example",level:3},{value:"Installation and Usage",id:"installation-and-usage",level:2},{value:"1. Install the Sync Service",id:"1-install-the-sync-service",level:3},{value:"2. Configure the Sync Service",id:"2-configure-the-sync-service",level:3},{value:"3. Start the Service",id:"3-start-the-service",level:3},{value:"4. Verify Operation",id:"4-verify-operation",level:3},{value:"Under the Hood: How the Sync Service Works",id:"under-the-hood-how-the-sync-service-works",level:2},{value:"How NetBox Integration Works",id:"how-netbox-integration-works",level:3},{value:"Firewall Configuration",id:"firewall-configuration",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Service Won&#39;t Start",id:"service-wont-start",level:3},{value:"Integration Issues",id:"integration-issues",level:3},{value:"Permission Issues",id:"permission-issues",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Example: Complete Sync Configuration",id:"example-complete-sync-configuration",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"sync-service-configuration",children:"Sync Service Configuration"})}),"\n",(0,s.jsx)(n.p,{children:"The ServiceRadar Sync service integrates external data sources with ServiceRadar's monitoring capabilities. It works with the KV Store to automatically synchronize device information from external systems and generate appropriate monitoring configurations. This allows for automatic discovery and monitoring of devices from systems like NetBox, Armis, and other inventory or security platforms."}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"The Sync service:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Fetches data from external systems like CMDB, IPAM, or security tools"}),"\n",(0,s.jsx)(n.li,{children:"Converts this data into ServiceRadar configurations"}),"\n",(0,s.jsx)(n.li,{children:"Stores the configurations in the KV Store for automatic consumption by agents"}),"\n",(0,s.jsx)(n.li,{children:"Runs on a configurable schedule for continuous synchronization"}),"\n",(0,s.jsx)(n.li,{children:"Supports multiple data sources with different integration types"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,s.jsx)(n.mermaid,{value:'graph TD\n    subgraph "Sync Architecture"\n        Sync[Sync Service] --\x3e|Fetch| ExternalSystems[External Systems<br/>NetBox, Armis, etc.]\n        Sync --\x3e|Store| KV[KV Store<br/>:50057]\n        Agent[Agent] --\x3e|Read| KV\n    end'}),"\n",(0,s.jsx)(n.p,{children:"The Sync service integrates with external systems, fetches device and service information, and makes it available to ServiceRadar agents through the KV Store. This creates a seamless workflow where network inventory systems can automatically update monitoring configurations without manual intervention."}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(n.p,{children:"Before configuring the Sync service, ensure you have:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Installed the KV service (see ",(0,s.jsx)(n.a,{href:"/docs/kv-configuration",children:"KV Store Configuration"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Generated and deployed TLS certificates for mTLS security"}),"\n",(0,s.jsx)(n.li,{children:"API access to your external data sources (credentials, endpoints, etc.)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The Sync service is configured via ",(0,s.jsx)(n.code,{children:"/etc/serviceradar/sync.json"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "kv_address": "192.168.2.23:50057",\n  "listen_addr": "192.168.2.23:50058",\n  "poll_interval": "5m",\n  "security": {\n    "mode": "mtls",\n    "cert_dir": "/etc/serviceradar/certs",\n    "server_name": "192.168.2.23",\n    "role": "poller",\n    "tls": {\n      "cert_file": "sync.pem",\n      "key_file": "sync-key.pem",\n      "ca_file": "root.pem",\n      "client_ca_file": "root.pem"\n    }\n  },\n  "sources": {\n    "netbox": {\n      "type": "netbox",\n      "endpoint": "https://192.168.2.73",\n      "prefix": "netbox/",\n      "credentials": {\n        "api_token": "72d72b0ddddddd3f7951051cd78cd7c"\n      },\n      "insecure_skip_verify": true\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Option"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Required"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"sources"})}),(0,s.jsx)(n.td,{children:"Map of external data sources to fetch from"}),(0,s.jsx)(n.td,{children:"N/A"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"kv_address"})}),(0,s.jsx)(n.td,{children:"Address and port of the KV service"}),(0,s.jsx)(n.td,{children:"N/A"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"listen_addr"})}),(0,s.jsx)(n.td,{children:"Address and port for the Sync service to listen on"}),(0,s.jsx)(n.td,{children:"N/A"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"poll_interval"})}),(0,s.jsx)(n.td,{children:"How often to fetch and update data"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"30m"})}),(0,s.jsx)(n.td,{children:"No"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"security"})}),(0,s.jsx)(n.td,{children:"mTLS security settings"}),(0,s.jsx)(n.td,{children:"N/A"}),(0,s.jsx)(n.td,{children:"Yes"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"source-configuration",children:"Source Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["Each source in the ",(0,s.jsx)(n.code,{children:"sources"})," map requires:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Option"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Required"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"type"})}),(0,s.jsx)(n.td,{children:'Integration type (e.g., "netbox", "armis")'}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"endpoint"})}),(0,s.jsx)(n.td,{children:"API endpoint URL"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"prefix"})}),(0,s.jsx)(n.td,{children:"Key prefix in the KV store"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"credentials"})}),(0,s.jsx)(n.td,{children:"Authentication credentials (API keys, tokens)"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"insecure_skip_verify"})}),(0,s.jsx)(n.td,{children:"Skip TLS verification for self-signed certificates"}),(0,s.jsx)(n.td,{children:"No"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"supported-integrations",children:"Supported Integrations"}),"\n",(0,s.jsx)(n.p,{children:"The Sync service supports the following integration types:"}),"\n",(0,s.jsx)(n.h3,{id:"netbox-integration",children:"NetBox Integration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'"netbox": {\n  "type": "netbox",\n  "endpoint": "https://netbox.example.com/api",\n  "prefix": "netbox/",\n  "credentials": {\n    "api_token": "your_netbox_token",\n    "expand_subnets": "true"\n  },\n  "insecure_skip_verify": true\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"The NetBox integration:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Retrieves IP addresses, devices, and VMs from NetBox"}),"\n",(0,s.jsx)(n.li,{children:"Creates monitor configurations based on device types and services"}),"\n",(0,s.jsxs)(n.li,{children:["Stores the configurations in the KV store with prefix ",(0,s.jsx)(n.code,{children:"netbox/"})]}),"\n",(0,s.jsxs)(n.li,{children:["Supports subnet expansion with the ",(0,s.jsx)(n.code,{children:"expand_subnets"})," option"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"netbox-specific-options",children:"NetBox-Specific Options"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Option"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Required"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"api_token"})}),(0,s.jsx)(n.td,{children:"NetBox API token"}),(0,s.jsx)(n.td,{children:"N/A"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"expand_subnets"})}),(0,s.jsx)(n.td,{children:"Use subnet masks from NetBox instead of /32"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"No"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"insecure_skip_verify"})}),(0,s.jsx)(n.td,{children:"Skip TLS verification"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"No"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"armis-integration",children:"Armis Integration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'"armis": {\n  "type": "armis",\n  "endpoint": "https://api.armis.com/api/v1/devices",\n  "prefix": "armis/",\n  "credentials": {\n    "api_key": "your_armis_api_key"\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"The Armis integration:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Fetches device information from Armis"}),"\n",(0,s.jsx)(n.li,{children:"Creates device records in the KV store"}),"\n",(0,s.jsx)(n.li,{children:"Automatically generates network sweep configurations for discovered devices"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"armis-specific-options",children:"Armis-Specific Options"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Option"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Required"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"api_key"})}),(0,s.jsx)(n.td,{children:"Armis API key"}),(0,s.jsx)(n.td,{children:"N/A"}),(0,s.jsx)(n.td,{children:"Yes"})]})})]}),"\n",(0,s.jsx)(n.h2,{id:"security-requirements",children:"Security Requirements"}),"\n",(0,s.jsx)(n.h3,{id:"mtls-configuration",children:"mTLS Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The Sync service ",(0,s.jsx)(n.strong,{children:"requires"})," mTLS for security. The following settings are mandatory:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'"security": {\n  "mode": "mtls",\n  "cert_dir": "/etc/serviceradar/certs",\n  "server_name": "your-kv-server-ip-or-hostname",\n  "role": "poller",\n  "tls": {\n    "cert_file": "sync.pem",\n    "key_file": "sync-key.pem",\n    "ca_file": "root.pem",\n    "client_ca_file": "root.pem"\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"cert_file"}),", ",(0,s.jsx)(n.code,{children:"key_file"}),", and ",(0,s.jsx)(n.code,{children:"ca_file"})," paths are relative to the ",(0,s.jsx)(n.code,{children:"cert_dir"})," if not absolute"]}),"\n",(0,s.jsx)(n.li,{children:"Use absolute paths when certificates are stored outside the default directory"}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"server_name"})," must match the hostname/IP in the KV service's certificate"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"kv-store-rbac-configuration",children:"KV Store RBAC Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The Sync service requires ",(0,s.jsx)(n.code,{children:"writer"})," access to the KV store. Update your KV service configuration (",(0,s.jsx)(n.code,{children:"/etc/serviceradar/kv.json"}),") to include the Sync service's certificate identity:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'"rbac": {\n  "roles": [\n    {"identity": "CN=sync.serviceradar,O=ServiceRadar", "role": "writer"},\n    {"identity": "CN=agent.serviceradar,O=ServiceRadar", "role": "reader"}\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"agent-configuration-for-kv",children:"Agent Configuration for KV"}),"\n",(0,s.jsxs)(n.p,{children:["To allow agents to read configurations created by the Sync service, update your agent configuration (",(0,s.jsx)(n.code,{children:"/etc/serviceradar/agent.json"}),") to include KV store access:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "checkers_dir": "/etc/serviceradar/checkers",\n  "listen_addr": "192.168.2.23:50051",\n  "service_type": "grpc",\n  "service_name": "AgentService",\n  "agent_id": "default-agent",\n  "agent_name": "192.168.2.23",\n  "security": {\n    "mode": "mtls",\n    "cert_dir": "/etc/serviceradar/certs",\n    "server_name": "192.168.2.23",\n    "role": "agent",\n    "tls": {\n      "cert_file": "agent.pem",\n      "key_file": "agent-key.pem",\n      "ca_file": "root.pem"\n    }\n  },\n  "kv_address": "192.168.2.23:50057",\n  "kv_security": {\n    "mode": "mtls",\n    "cert_dir": "/etc/serviceradar/certs",\n    "server_name": "192.168.2.23",\n    "role": "agent",\n    "tls": {\n      "cert_file": "kv-client.pem",\n      "key_file": "kv-client-key.pem",\n      "ca_file": "root.pem"\n    }\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Note the ",(0,s.jsx)(n.code,{children:"kv_address"})," and ",(0,s.jsx)(n.code,{children:"kv_security"})," sections which enable the agent to connect to the KV store and retrieve dynamic configurations."]}),"\n",(0,s.jsx)(n.h2,{id:"generated-configurations",children:"Generated Configurations"}),"\n",(0,s.jsx)(n.p,{children:"The Sync service automatically generates configurations that agents can consume. These configurations are stored in the KV store under keys that follow this pattern:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"agents/<hostname>/checkers/<checker-type>/<checker-name>.json\n"})}),"\n",(0,s.jsx)(n.h3,{id:"network-sweep-configuration-example",children:"Network Sweep Configuration Example"}),"\n",(0,s.jsx)(n.p,{children:"For discovered IP addresses, the Sync service creates network sweep configurations like this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "networks": [\n    "192.168.1.1/32",\n    "192.168.1.2/32",\n    "192.168.1.3/32",\n    "192.168.1.4/32",\n    "192.168.1.5/32"\n  ],\n  "ports": [22, 80, 443, 3306, 5432, 6379, 8080, 8443],\n  "sweep_modes": ["icmp", "tcp"],\n  "interval": "5m",\n  "concurrency": 100,\n  "timeout": "10s",\n  "icmp_count": 1,\n  "high_perf_icmp": true,\n  "icmp_rate_limit": 5000\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["This configuration would be stored at a key like ",(0,s.jsx)(n.code,{children:"agents/192.168.2.23/checkers/sweep/sweep.json"})," in the KV store."]}),"\n",(0,s.jsx)(n.h2,{id:"installation-and-usage",children:"Installation and Usage"}),"\n",(0,s.jsx)(n.h3,{id:"1-install-the-sync-service",children:"1. Install the Sync Service"}),"\n",(0,s.jsx)(n.p,{children:"The Sync service is distributed as a separate package:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Debian/Ubuntu\ncurl -LO https://github.com/carverauto/serviceradar/releases/download/1.0.33/serviceradar-sync_1.0.33.deb\nsudo dpkg -i serviceradar-sync_1.0.33.deb\n\n# RHEL/Oracle Linux\ncurl -LO https://github.com/carverauto/serviceradar/releases/download/1.0.33/serviceradar-sync-1.0.33-1.el9.x86_64.rpm\nsudo dnf install -y ./serviceradar-sync-1.0.33-1.el9.x86_64.rpm\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-configure-the-sync-service",children:"2. Configure the Sync Service"}),"\n",(0,s.jsxs)(n.p,{children:["Create or edit ",(0,s.jsx)(n.code,{children:"/etc/serviceradar/sync.json"})," with your configuration."]}),"\n",(0,s.jsx)(n.h3,{id:"3-start-the-service",children:"3. Start the Service"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo systemctl start serviceradar-sync\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-verify-operation",children:"4. Verify Operation"}),"\n",(0,s.jsx)(n.p,{children:"Check that the service is running:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo systemctl status serviceradar-sync\n"})}),"\n",(0,s.jsx)(n.p,{children:"Review logs for synchronization activity:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo journalctl -u serviceradar-sync --since today\n"})}),"\n",(0,s.jsx)(n.p,{children:"Verify that data is being stored in the KV store:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Verify data in the KV store using the NATS CLI\nnats kv get serviceradar-kv agents/192.168.2.23/checkers/sweep/sweep.json \\\n  --server tls://192.168.2.23:4222 \\ \n  --tlscert /etc/serviceradar/certs/client.pem \\\n  --tlskey /etc/serviceradar/certs/client-key.pem \\\n  --tlsca /etc/serviceradar/certs/root.pem --raw\n"})}),"\n",(0,s.jsx)(n.h2,{id:"under-the-hood-how-the-sync-service-works",children:"Under the Hood: How the Sync Service Works"}),"\n",(0,s.jsx)(n.p,{children:"The Sync service operates on a simple yet powerful principle:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"At the configured poll interval, it connects to each configured external source"}),"\n",(0,s.jsx)(n.li,{children:"It fetches device information and converts it to ServiceRadar configurations"}),"\n",(0,s.jsx)(n.li,{children:"It writes the configurations to the KV store using the configured prefixes"}),"\n",(0,s.jsx)(n.li,{children:"Agents configured to use the KV store automatically pick up these configurations"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"how-netbox-integration-works",children:"How NetBox Integration Works"}),"\n",(0,s.jsx)(n.p,{children:"The NetBox integration:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Connects to the NetBox API using the provided token"}),"\n",(0,s.jsx)(n.li,{children:"Retrieves device information including IP addresses"}),"\n",(0,s.jsx)(n.li,{children:"Processes the device data to extract relevant monitoring information"}),"\n",(0,s.jsxs)(n.li,{children:["For each device with a primary IP address:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Stores the device data in the KV store"}),"\n",(0,s.jsx)(n.li,{children:"Adds the IP to a network sweep configuration"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Writes the complete sweep configuration to the KV store"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.code,{children:"expand_subnets"})," is enabled, the integration will use the subnet masks as defined in NetBox. Otherwise, it treats all IPs as /32 (individual hosts)."]}),"\n",(0,s.jsx)(n.h2,{id:"firewall-configuration",children:"Firewall Configuration"}),"\n",(0,s.jsx)(n.p,{children:"If you're using a firewall, you need to open ports for the Sync service:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# For UFW (Ubuntu)\nsudo ufw allow 50058/tcp  # Sync service gRPC port\n\n# For firewalld (RHEL/Oracle Linux)\nsudo firewall-cmd --permanent --add-port=50058/tcp\nsudo firewall-cmd --reload\n"})}),"\n",(0,s.jsx)(n.p,{children:"Make sure the Sync service can also reach:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Your KV service (typically port 50057)"}),"\n",(0,s.jsx)(n.li,{children:"Your external APIs (typically HTTPS on port 443)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"service-wont-start",children:"Service Won't Start"}),"\n",(0,s.jsx)(n.p,{children:"Check the logs for detailed error information:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo journalctl -u serviceradar-sync -n 100\n"})}),"\n",(0,s.jsx)(n.p,{children:"Common issues include:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Incorrect certificate paths"}),"\n",(0,s.jsx)(n.li,{children:"Invalid credentials for external systems"}),"\n",(0,s.jsx)(n.li,{children:"KV service not running or unreachable"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"integration-issues",children:"Integration Issues"}),"\n",(0,s.jsx)(n.p,{children:"If an integration isn't working:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Check that the API endpoint is accessible from the Sync service:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl -k https://your-netbox-server/api/dcim/devices/\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Verify the credentials are valid (try a manual API call with the token)"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Ensure the prefix is correctly configured in both Sync and KV configurations"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Look for specific error messages in the logs:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'grep "error" /var/log/serviceradar-sync.log\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"permission-issues",children:"Permission Issues"}),"\n",(0,s.jsx)(n.p,{children:"If the Sync service can't write to the KV store:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Verify the certificate's identity matches an entry in the KV service's RBAC configuration with ",(0,s.jsx)(n.code,{children:"writer"})," role"]}),"\n",(0,s.jsx)(n.li,{children:"Check that the TLS certificates are valid and readable by the Sync service"}),"\n",(0,s.jsxs)(n.li,{children:["Ensure the ",(0,s.jsx)(n.code,{children:"server_name"})," matches the KV service's certificate"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use Separate Prefixes"}),": Give each data source a unique prefix to avoid key conflicts"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Set Appropriate Poll Intervals"}),": Consider API rate limits and data freshness requirements"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Secure Credentials"}),": Use environment variables or a secure vault for sensitive credentials rather than storing them directly in the configuration file"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Monitor Sync Activity"}),": Set up monitoring for the Sync service itself to ensure it's operating correctly"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Backup Configurations"}),": Periodically backup your Sync service configuration and related certificates"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"example-complete-sync-configuration",children:"Example: Complete Sync Configuration"}),"\n",(0,s.jsx)(n.p,{children:"Here's a comprehensive example that includes multiple data sources:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "kv_address": "192.168.2.23:50057",\n  "listen_addr": "192.168.2.23:50058",\n  "poll_interval": "5m",\n  "security": {\n    "mode": "mtls",\n    "cert_dir": "/etc/serviceradar/certs",\n    "server_name": "192.168.2.23",\n    "role": "poller",\n    "tls": {\n      "cert_file": "sync.pem",\n      "key_file": "sync-key.pem",\n      "ca_file": "root.pem",\n      "client_ca_file": "root.pem"\n    }\n  },\n  "sources": {\n    "netbox": {\n      "type": "netbox",\n      "endpoint": "https://192.168.2.73",\n      "prefix": "netbox/",\n      "credentials": {\n        "api_token": "72d72b0ddddddd3f7951051cd78cd7c",\n        "expand_subnets": "true"\n      },\n      "insecure_skip_verify": true\n    },\n    "armis": {\n      "type": "armis",\n      "endpoint": "https://api.armis.internal/v1/devices",\n      "prefix": "armis/",\n      "credentials": {\n        "api_key": "your_armis_api_key"\n      }\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"With this configuration, the Sync service will connect to both NetBox and Armis, retrieve device information from both systems, and create network sweep configurations that will be automatically picked up by agents configured to use the KV store."}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Set up ",(0,s.jsx)(n.a,{href:"/docs/tls-security",children:"TLS Security"})," to secure communications between components"]}),"\n",(0,s.jsxs)(n.li,{children:["Configure your ",(0,s.jsx)(n.a,{href:"/docs/configuration#agent-configuration",children:"Agents"})," to use the KV store"]}),"\n",(0,s.jsxs)(n.li,{children:["Learn more about ",(0,s.jsx)(n.a,{href:"/docs/architecture",children:"ServiceRadar's Architecture"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);