{
  "listen_addr": "0.0.0.0:50095",
  "nats_url": "nats://127.0.0.1:4222",
  "stream_name": "netflow.metrics",
  "consumer_name": "netflow-consumer",
  "enabled_fields": [
    "src_addr",
    "dst_addr",
    "bytes",
    "packets",
    "protocol"
  ],
  "disabled_fields": [],
  "dictionaries": [
    {
      "name": "applications",
      "source": "/etc/serviceradar/dictionaries/applications.csv",
      "keys": [
        "src_port",
        "dst_port"
      ],
      "attributes": [
        "application"
      ],
      "layout": "hashed"
    }
  ],
  "database": {
    "addresses": [
      "proton:9440"
    ],
    "name": "default",
    "username": "default",
    "password": "PLACEHOLDER_WILL_BE_REPLACED",
    "max_conns": 10,
    "idle_conns": 5,
    "settings": {
      "max_execution_time": 60,
      "output_format_json_quote_64bit_int": 0,
      "allow_experimental_live_views": 1,
      "idle_connection_timeout": 600,
      "join_use_nulls": 1,
      "input_format_defaults_for_omitted_fields": 1
    }
  },
  "security": {
    "mode": "mtls",
    "cert_dir": "/etc/serviceradar/certs",
    "server_name": "nats.serviceradar",
    "role": "netflow",
    "tls": {
      "cert_file": "/etc/serviceradar/certs/netflow.pem",
      "key_file": "/etc/serviceradar/certs/netflow-key.pem",
      "ca_file": "/etc/serviceradar/certs/root.pem",
      "client_ca_file": "/etc/serviceradar/certs/root.pem"
    }
  }
}
