<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tls-security" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">TLS Security | ServiceRadar</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.serviceradar.cloud/img/serviceradar-social-card.png"><meta data-rh="true" name="twitter:image" content="https://docs.serviceradar.cloud/img/serviceradar-social-card.png"><meta data-rh="true" property="og:url" content="https://docs.serviceradar.cloud/docs/tls-security"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="TLS Security | ServiceRadar"><meta data-rh="true" name="description" content="ServiceRadar supports mutual TLS (mTLS) authentication to secure communications between components."><meta data-rh="true" property="og:description" content="ServiceRadar supports mutual TLS (mTLS) authentication to secure communications between components."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.serviceradar.cloud/docs/tls-security"><link data-rh="true" rel="alternate" href="https://docs.serviceradar.cloud/docs/tls-security" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.serviceradar.cloud/docs/tls-security" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="ServiceRadar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="ServiceRadar Atom Feed"><link rel="stylesheet" href="/assets/css/styles.cff3da27.css">
<script src="/assets/js/runtime~main.08b9427a.js" defer="defer"></script>
<script src="/assets/js/main.df7a49eb.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_Eh5a" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="ServiceRadar logo" class="themedComponent_GK5N themedComponent--light_Njwa"><img src="/img/logo.svg" alt="ServiceRadar logo" class="themedComponent_GK5N themedComponent--dark_luXg"></div><b class="navbar__title text--truncate">ServiceRadar</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://demo.serviceradar.cloud" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Demo<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_i9lf"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/carverauto/serviceradar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_i9lf"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_rZG_ colorModeToggle_IX2O"><button class="clean-btn toggleButton_ipCA toggleButtonDisabled_FW4d" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_rUsA"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_EZlo"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_kiJH"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_ocBu"><div class="docsWrapper_dxes"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_g4fp" type="button"></button><div class="docRoot_sUXT"><aside class="theme-doc-sidebar-container docSidebarContainer_I1Hk"><div class="sidebarViewport_wwR5"><div class="sidebar_d9SN"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_pEQn"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">ServiceRadar Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/installation">Installation Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/configuration">Configuration Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/tls-security">TLS Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/web-ui">Web UI Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/custom-checkers">Creating a Custom Checker Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/kv-configuration">KV Store Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/sync">Sync Service Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/auth-configuration">Authentication Configuration</a></li></ul></nav></div></div></aside><main class="docMainContainer_vavl"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_LAEB"><div class="docItemContainer_APHI"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_OpQr" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_gpEY"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">TLS Security</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_lIwa theme-doc-toc-mobile tocMobile_ngzp"><button type="button" class="clean-btn tocCollapsibleButton_dSj2">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>TLS Security</h1></header>
<p>ServiceRadar supports mutual TLS (mTLS) authentication to secure communications between components.
This guide explains how to set up and configure mTLS for your ServiceRadar deployment, including the
NATS JetStream server used for the KV store.</p>
<h2 class="anchor anchorWithStickyNavbar_fAd0" id="security-architecture">Security Architecture<a href="#security-architecture" class="hash-link" aria-label="Direct link to Security Architecture" title="Direct link to Security Architecture">​</a></h2>
<p>ServiceRadar components communicate securely using mTLS with the following roles:</p>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_fAd0" id="certificate-overview">Certificate Overview<a href="#certificate-overview" class="hash-link" aria-label="Direct link to Certificate Overview" title="Direct link to Certificate Overview">​</a></h2>
<p>ServiceRadar uses the following certificate files:</p>
<ul>
<li><code>root.pem</code>: Root CA certificate (shared across all components).</li>
<li><code>&lt;component&gt;.pem</code>: Component-specific certificate (e.g., <code>agent.pem</code>, <code>kv.pem</code>, <code>nats-server.pem</code>).</li>
<li><code>&lt;component&gt;-key.pem</code>: Component-specific private key.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_fAd0" id="certificate-generation">Certificate Generation<a href="#certificate-generation" class="hash-link" aria-label="Direct link to Certificate Generation" title="Direct link to Certificate Generation">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_fAd0" id="1-install-cfssl">1. Install cfssl<a href="#1-install-cfssl" class="hash-link" aria-label="Direct link to 1. Install cfssl" title="Direct link to 1. Install cfssl">​</a></h3>
<p>First, install the CloudFlare SSL toolkit (cfssl) which we&#x27;ll use for generating certificates:</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">go install github.com/cloudflare/cfssl/cmd/...@latest</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_fAd0" id="2-create-configuration-files">2. Create Configuration Files<a href="#2-create-configuration-files" class="hash-link" aria-label="Direct link to 2. Create Configuration Files" title="Direct link to 2. Create Configuration Files">​</a></h3>
<p>Create <code>cfssl.json</code>:</p>
<div class="language-json codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-json codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;signing&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;default&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;expiry&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;8760h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;profiles&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;rootca&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;usages&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;signing&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;key encipherment&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;server auth&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;client auth&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;expiry&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;8760h&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;ca_constraint&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token property" style="color:#36acaa">&quot;is_ca&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token property" style="color:#36acaa">&quot;max_path_len&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;server&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;usages&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;signing&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;key encipherment&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;server auth&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;expiry&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;8760h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;client&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;usages&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;signing&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;key encipherment&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;client auth&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;expiry&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;8760h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_fAd0" id="component-specific-csrs">Component-Specific CSRs<a href="#component-specific-csrs" class="hash-link" aria-label="Direct link to Component-Specific CSRs" title="Direct link to Component-Specific CSRs">​</a></h4>
<p>Each component needs a Certificate Signing Request (CSR) with a unique <code>CN</code> and appropriate hosts.
Replace <code>&lt;ip-or-hostname&gt;</code> with the actual IP or hostname of the server hosting the component.</p>
<p><strong>NATS JetStream (<code>nats-csr.json</code>)</strong>:</p>
<div class="language-json codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-json codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;hosts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;localhost&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nats-serviceradar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;nats-server-ip-or-hostname&gt;&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;algo&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ecdsa&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;size&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;names&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;O&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ServiceRadar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;CN&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nats-serviceradar&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>serviceradar-kv (<code>kv-csr.json</code>)</strong>:</p>
<div class="language-json codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-json codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;hosts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;localhost&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;kv.serviceradar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;kv-server-ip-or-hostname&gt;&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;algo&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ecdsa&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;size&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;names&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;O&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ServiceRadar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;CN&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;kv.serviceradar&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Agent (<code>agent-csr.json</code>)</strong>:</p>
<div class="language-json codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-json codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;hosts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;localhost&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;agent-server-ip-or-hostname&gt;&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;algo&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ecdsa&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;size&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;names&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;O&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ServiceRadar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;CN&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;agent.serviceradar&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Poller (<code>poller-csr.json</code>)</strong>:</p>
<div class="language-json codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-json codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;hosts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;localhost&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;poller-server-ip-or-hostname&gt;&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;algo&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ecdsa&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;size&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;names&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;O&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ServiceRadar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;CN&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;poller.serviceradar&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Core (<code>core-csr.json</code>)</strong>:</p>
<div class="language-json codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-json codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;hosts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;localhost&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;core-server-ip-or-hostname&gt;&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;algo&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ecdsa&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;size&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;names&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;O&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ServiceRadar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;CN&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;core.serviceradar&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_kCc1 alert alert--secondary"><div class="admonitionHeading_WWyw"><span class="admonitionIcon_tH_p"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_lI_Q"><p>Use <code>localhost</code> and <code>127.0.0.1</code> for co-located deployments; add specific IPs or hostnames (e.g., <code>192.168.1.100</code>, <code>agent.example.com</code>) for distributed setups.</p><p>The <code>CN</code> must be unique per component to enable RBAC in <code>serviceradar-kv</code>.</p><p>Modify the &quot;hosts&quot; array in csr.json and nats-csr.json to include the actual hostnames and IP addresses of your ServiceRadar components and NATS Server.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_fAd0" id="3-generate-certificates">3. Generate Certificates<a href="#3-generate-certificates" class="hash-link" aria-label="Direct link to 3. Generate Certificates" title="Direct link to 3. Generate Certificates">​</a></h3>
<p>Generate the root CA:</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">cfssl selfsign -config cfssl.json --profile rootca &quot;ServiceRadar CA&quot; csr.json | cfssljson -bare root</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Generate and sign certificates for each component:</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain"># NATS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfssl genkey nats-csr.json | cfssljson -bare nats-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfssl sign -ca root.pem -ca-key root-key.pem -config cfssl.json -profile server nats-server.csr | cfssljson -bare nats-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># serviceradar-kv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfssl genkey kv-csr.json | cfssljson -bare kv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfssl sign -ca root.pem -ca-key root-key.pem -config cfssl.json -profile client kv.csr | cfssljson -bare kv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfssl genkey agent-csr.json | cfssljson -bare agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfssl sign -ca root.pem -ca-key root-key.pem -config cfssl.json -profile client agent.csr | cfssljson -bare agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Poller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfssl genkey poller-csr.json | cfssljson -bare poller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfssl sign -ca root.pem -ca-key root-key.pem -config cfssl.json -profile client poller.csr | cfssljson -bare poller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Core</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfssl genkey core-csr.json | cfssljson -bare core</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfssl sign -ca root.pem -ca-key root-key.pem -config cfssl.json -profile server core.csr | cfssljson -bare core</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_kCc1 alert alert--secondary"><div class="admonitionHeading_WWyw"><span class="admonitionIcon_tH_p"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_lI_Q"><p>Use the server profile for components that only act as servers (e.g., nats-server, core).</p><p>Use the client profile for components that act as clients (e.g., agent, poller, kv when connecting to NATS).</p><p>serviceradar-kv needs client auth for NATS mTLS and server auth for its gRPC service. For simplicity, we use the client profile here since NATS requires it, and the gRPC server accepts it in practice. For strict separation, generate separate client and server certs (e.g., kv-client.pem, kv-server.pem).</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_fAd0" id="certificate-deployment">Certificate Deployment<a href="#certificate-deployment" class="hash-link" aria-label="Direct link to Certificate Deployment" title="Direct link to Certificate Deployment">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_fAd0" id="role-based-requirements">Role-Based Requirements<a href="#role-based-requirements" class="hash-link" aria-label="Direct link to Role-Based Requirements" title="Direct link to Role-Based Requirements">​</a></h3>
<p>Different ServiceRadar components need different certificates based on their role:</p>
<table><thead><tr><th>Component</th><th>Role</th><th>Certificates Needed</th></tr></thead><tbody><tr><td>Poller</td><td>Client+Server</td><td><code>root.pem</code>, <code>poller.pem</code>, <code>poller-key.pem</code></td></tr><tr><td>Agent</td><td>Client+Server</td><td><code>root.pem</code>, <code>agent.pem</code>, <code>agent-key.pem</code></td></tr><tr><td>Core</td><td>Server only</td><td><code>root.pem</code>, <code>core.pem</code>, <code>core-key.pem</code></td></tr><tr><td>Checker</td><td>Server only</td><td><code>root.pem</code>, <code>&lt;checker&gt;.pem</code>, <code>&lt;checker&gt;-key.pem</code></td></tr><tr><td>NATS JetStream</td><td>Server only</td><td><code>root.pem</code>, <code>nats-server.pem</code>, <code>nats-server-key.pem</code></td></tr><tr><td>serviceradar-kv</td><td>Client+Server</td><td><code>root.pem</code>, <code>kv.pem</code>, <code>kv-key.pem</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_fAd0" id="installation-steps">Installation Steps<a href="#installation-steps" class="hash-link" aria-label="Direct link to Installation Steps" title="Direct link to Installation Steps">​</a></h3>
<ol>
<li>Create the certificates directory:</li>
</ol>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">sudo mkdir -p /etc/serviceradar/certs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown serviceradar:serviceradar /etc/serviceradar/certs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 700 /etc/serviceradar/certs</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Deploy certificates</li>
</ol>
<p><strong>serviceradar-nats</strong>:</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp root.pem nats-server.pem nats-server-key.pem /etc/serviceradar/certs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown nats:nats /etc/serviceradar/certs/nats-server.pem /etc/serviceradar/certs/nats-server-key.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 644 /etc/serviceradar/certs/nats-server.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 600 /etc/serviceradar/certs/nats-server-key.pem</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>serviceradar-kv</strong>:</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp root.pem kv.pem kv-key.pem /etc/serviceradar/certs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown serviceradar:serviceradar /etc/serviceradar/certs/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 644 /etc/serviceradar/certs/*.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 600 /etc/serviceradar/certs/*-key.pem</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>serviceradar-agent</strong>:</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp root.pem agent.pem agent-key.pem /etc/serviceradar/certs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown serviceradar:serviceradar /etc/serviceradar/certs/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 644 /etc/serviceradar/certs/*.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 600 /etc/serviceradar/certs/*-key.pem</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>serviceradar-poller</strong>:</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp root.pem poller.pem poller-key.pem /etc/serviceradar/certs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown serviceradar:serviceradar /etc/serviceradar/certs/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 644 /etc/serviceradar/certs/*.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 600 /etc/serviceradar/certs/*-key.pem</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>serviceradar-core</strong>:</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp root.pem core.pem core-key.pem /etc/serviceradar/certs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown serviceradar:serviceradar /etc/serviceradar/certs/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 644 /etc/serviceradar/certs/*.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 600 /etc/serviceradar/certs/*-key.pem</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>serviceradar-&lt;checker&gt;</strong>:</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp root.pem &lt;checker&gt;.pem &lt;checker&gt;-key.pem /etc/serviceradar/certs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown serviceradar:serviceradar /etc/serviceradar/certs/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 644 /etc/serviceradar/certs/*.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 600 /etc/serviceradar/certs/*-key.pem</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Set permissions:</li>
</ol>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown serviceradar:serviceradar /etc/serviceradar/certs/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 644 /etc/serviceradar/certs/*.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 600 /etc/serviceradar/certs/*-key.pem</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_fAd0" id="grant-nats-access-if-co-located">Grant NATS Access (if co-located):<a href="#grant-nats-access-if-co-located" class="hash-link" aria-label="Direct link to Grant NATS Access (if co-located):" title="Direct link to Grant NATS Access (if co-located):">​</a></h4>
<p>If NATS runs on the same server as other components, add the nats user to the serviceradar group:</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain"># Add the nats user to the serviceradar group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo usermod -aG serviceradar nats</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Ensure the directory is group-readable:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 750 /etc/serviceradar/certs</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_fAd0" id="expected-directory-structure">Expected Directory Structure<a href="#expected-directory-structure" class="hash-link" aria-label="Direct link to Expected Directory Structure" title="Direct link to Expected Directory Structure">​</a></h3>
<ul>
<li>NATS Server (standalone):</li>
</ul>
<div class="codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-text codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">/etc/serviceradar/certs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── root.pem           (644, serviceradar:serviceradar)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── nats-server.pem    (644, nats:nats)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── nats-server-key.pem (600, nats:nats)</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Full Deployment (e.g., Agent + KV + NATS co-located)</li>
</ul>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">/etc/serviceradar/certs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── root.pem           (644, serviceradar:serviceradar)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── agent.pem          (644, serviceradar:serviceradar)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── agent-key.pem      (600, serviceradar:serviceradar)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── kv.pem             (644, serviceradar:serviceradar)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── kv-key.pem         (600, serviceradar:serviceradar)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── nats-server.pem    (644, nats:nats)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── nats-server-key.pem (600, nats:nats)</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Full deployment (Poller/Agent/serviceradar-kv):</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">/etc/serviceradar/certs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── root.pem           (644)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── server.pem         (644)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── server-key.pem     (600)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── client.pem         (644)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── client-key.pem     (600)</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_fAd0" id="component-configuration">Component Configuration<a href="#component-configuration" class="hash-link" aria-label="Direct link to Component Configuration" title="Direct link to Component Configuration">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_fAd0" id="agent-configuration">Agent Configuration<a href="#agent-configuration" class="hash-link" aria-label="Direct link to Agent Configuration" title="Direct link to Agent Configuration">​</a></h3>
<p>Update <code>/etc/serviceradar/agent.json</code>:</p>
<div class="language-json codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-json codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;checkers_dir&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/etc/serviceradar/checkers&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;listen_addr&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;agent-ip&gt;:50051&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;service_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;grpc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;service_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AgentService&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;security&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;mode&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mtls&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;cert_dir&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/etc/serviceradar/certs&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;server_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;kv.serviceradar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;agent&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;tls&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;cert_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;agent.pem&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;key_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;agent-key.pem&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;ca_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;root.pem&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Set <code>mode</code> to <code>mtls</code></li>
<li>Set <code>server_name</code> to the hostname/IP address of the poller</li>
<li>Set <code>role</code> to <code>agent</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_fAd0" id="poller-configuration">Poller Configuration<a href="#poller-configuration" class="hash-link" aria-label="Direct link to Poller Configuration" title="Direct link to Poller Configuration">​</a></h3>
<p>Update <code>/etc/serviceradar/poller.json</code>:</p>
<div class="language-json codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-json codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;agents&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;local-agent&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;address&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;agent-ip&gt;:50051&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;security&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;server_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;agent.serviceradar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;mode&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mtls&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;tls&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;cert_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;poller.pem&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;key_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;poller-key.pem&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;ca_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;root.pem&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;checks&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;core_address&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;core-ip&gt;:50052&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;listen_addr&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;poller-ip&gt;:50053&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;poll_interval&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;30s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;poller_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;my-poller&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;service_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;PollerService&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;service_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;grpc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;security&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;mode&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mtls&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;cert_dir&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/etc/serviceradar/certs&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;server_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;core.serviceradar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;poller&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;tls&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;cert_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;poller.pem&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;key_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;poller-key.pem&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;ca_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;root.pem&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_fAd0" id="core-configuration">Core Configuration<a href="#core-configuration" class="hash-link" aria-label="Direct link to Core Configuration" title="Direct link to Core Configuration">​</a></h3>
<p>Update <code>/etc/serviceradar/core.json</code>:</p>
<div class="language-json codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-json codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;listen_addr&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;:8090&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;grpc_addr&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;core-ip&gt;:50052&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;alert_threshold&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5m&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;known_pollers&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;my-poller&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;metrics&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;enabled&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;retention&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;max_nodes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;security&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;mode&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mtls&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;cert_dir&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/etc/serviceradar/certs&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;server_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;core.serviceradar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;core&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;tls&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;cert_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;core.pem&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;key_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;core-key.pem&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;ca_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;root.pem&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_fAd0" id="nats-jetstream-configuration">NATS JetStream Configuration<a href="#nats-jetstream-configuration" class="hash-link" aria-label="Direct link to NATS JetStream Configuration" title="Direct link to NATS JetStream Configuration">​</a></h3>
<p>The NATS Server configuration is already set up with mTLS in <code>/etc/nats/nats-server.conf</code>
(see the Installation Guide (./installation.md)). Ensure the certificates are correctly placed in
<code>/etc/serviceradar/certs/</code> as described above.</p>
<h3 class="anchor anchorWithStickyNavbar_fAd0" id="serviceradar-kv-configuration">serviceradar-kv Configuration<a href="#serviceradar-kv-configuration" class="hash-link" aria-label="Direct link to serviceradar-kv Configuration" title="Direct link to serviceradar-kv Configuration">​</a></h3>
<p>Update <code>/etc/serviceradar/kv.json</code> to enable mTLS for both the gRPC service and the connection to NATS:</p>
<div class="language-json codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-json codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;listen_addr&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;:50054&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;nats_url&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nats://nats-serviceradar:4222&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;security&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;mode&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mtls&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;cert_dir&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/etc/serviceradar/certs&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;server_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;kv.serviceradar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;server&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;rbac&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;roles&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;identity&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;CN=sync.serviceradar,O=Carver Automation&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;writer&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;identity&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;CN=agent.serviceradar,O=Carver Automation&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;reader&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Set <code>nats_url</code> to the NATS Server address, ensuring the hostname matches the <code>CN</code> in <code>nats-server.pem</code>.</li>
<li>Ensure mode is set to <code>mtls</code> to enable mTLS for the gRPC service.</li>
<li>The <code>serviceradar-kv</code> service will automatically use the client certificates (<code>client.pem</code> and <code>client-key.pem</code>) to connect to NATS with mTLS.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_fAd0" id="verification">Verification<a href="#verification" class="hash-link" aria-label="Direct link to Verification" title="Direct link to Verification">​</a></h2>
<p>Verify your installation with:</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">ls -la /etc/serviceradar/certs/</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example output (Core instance with NATS):</p>
<div class="codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-text codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">total 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwx------ 2 serviceradar serviceradar 4096 Feb 21 20:46 .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x 3 serviceradar serviceradar 4096 Feb 21 22:35 ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 serviceradar serviceradar  920 Feb 21 04:47 root.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw------- 1 serviceradar serviceradar  227 Feb 21 20:44 server-key.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 serviceradar serviceradar  928 Feb 21 20:45 server.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw------- 1 serviceradar serviceradar  227 Feb 21 20:44 nats-server-key.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 serviceradar serviceradar  928 Feb 21 20:45 nats-server.pem</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Verify the NATS Server connection:</p>
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain"># Install the NATS CLI if not already installed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go install github.com/nats-io/natscli/nats@latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Test the connection to NATS with mTLS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nats server check --server nats://nats-serviceradar:4222 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --tls-cert /etc/serviceradar/certs/client.pem \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --tls-key /etc/serviceradar/certs/client-key.pem \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --tls-ca /etc/serviceradar/certs/root.pem</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_fAd0" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<p>Common issues and solutions:</p>
<ol>
<li>
<p><strong>Permission denied</strong></p>
<ul>
<li>Verify directory permissions: <code>700</code></li>
<li>Verify file permissions: <code>644</code> for certificates, <code>600</code> for keys</li>
<li>Check ownership: <code>serviceradar:serviceradar</code></li>
</ul>
</li>
<li>
<p><strong>Certificate not found</strong></p>
<ul>
<li>Confirm all required certificates for the role are present</li>
<li>Double-check file paths in configuration</li>
</ul>
</li>
<li>
<p><strong>Invalid certificate</strong></p>
<ul>
<li>Ensure certificates are properly formatted PEM files</li>
<li>Verify certificates were generated with correct profiles</li>
</ul>
</li>
<li>
<p><strong>Connection refused</strong></p>
<ul>
<li>Verify server name in config matches certificate CN</li>
<li>Check that all required certificates are present for the role</li>
<li>Confirm service has proper read permissions</li>
</ul>
</li>
<li>
<p><strong>Testing with grpcurl</strong></p>
<ul>
<li>Install grpcurl: <code>go install github.com/fullstorydev/grpcurl/cmd/grpcurl@latest</code></li>
<li>Test health check endpoint with mTLS:<!-- -->
<div class="language-bash codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-bash codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token plain">grpcurl -cacert root.pem \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -cert client.pem \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -key client-key.pem \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -servername &lt;SERVER_IP&gt; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;SERVER_IP&gt;:50052 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        grpc.health.v1.Health/Check</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>Successful response should show:<!-- -->
<div class="language-json codeBlockContainer_HTPM theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_OwhC"><pre tabindex="0" class="prism-code language-json codeBlock_QQmy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_piqd"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;status&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SERVING&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_n6sy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_GuCM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_KWtG"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nnIb"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>If this fails but certificates are correct, verify:<!-- -->
<ul>
<li>Server is running and listening on specified port</li>
<li>Firewall rules allow the connection</li>
<li>The servername matches the certificate&#x27;s Common Name (CN)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>NATS Connection Issues</strong></p>
<ul>
<li>Check NATS Server logs: `sudo cat /var/log/nats/nats.log1</li>
<li>Verify the NATS URL in <code>/etc/serviceradar/kv.json</code> matches the hostname in <code>nats-server.pem</code>.</li>
<li>Ensure the client certificates are valid and trusted by the NATS Server.</li>
<li>Test the connection using the NATS CLI as shown in the Verification section.</li>
</ul>
</li>
</ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/configuration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Configuration Basics</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/web-ui"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Web UI Configuration</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_OiFf thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#security-architecture" class="table-of-contents__link toc-highlight">Security Architecture</a></li><li><a href="#certificate-overview" class="table-of-contents__link toc-highlight">Certificate Overview</a></li><li><a href="#certificate-generation" class="table-of-contents__link toc-highlight">Certificate Generation</a><ul><li><a href="#1-install-cfssl" class="table-of-contents__link toc-highlight">1. Install cfssl</a></li><li><a href="#2-create-configuration-files" class="table-of-contents__link toc-highlight">2. Create Configuration Files</a></li><li><a href="#3-generate-certificates" class="table-of-contents__link toc-highlight">3. Generate Certificates</a></li></ul></li><li><a href="#certificate-deployment" class="table-of-contents__link toc-highlight">Certificate Deployment</a><ul><li><a href="#role-based-requirements" class="table-of-contents__link toc-highlight">Role-Based Requirements</a></li><li><a href="#installation-steps" class="table-of-contents__link toc-highlight">Installation Steps</a></li><li><a href="#expected-directory-structure" class="table-of-contents__link toc-highlight">Expected Directory Structure</a></li></ul></li><li><a href="#component-configuration" class="table-of-contents__link toc-highlight">Component Configuration</a><ul><li><a href="#agent-configuration" class="table-of-contents__link toc-highlight">Agent Configuration</a></li><li><a href="#poller-configuration" class="table-of-contents__link toc-highlight">Poller Configuration</a></li><li><a href="#core-configuration" class="table-of-contents__link toc-highlight">Core Configuration</a></li><li><a href="#nats-jetstream-configuration" class="table-of-contents__link toc-highlight">NATS JetStream Configuration</a></li><li><a href="#serviceradar-kv-configuration" class="table-of-contents__link toc-highlight">serviceradar-kv Configuration</a></li></ul></li><li><a href="#verification" class="table-of-contents__link toc-highlight">Verification</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/carverauto/serviceradar/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_i9lf"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/dq6qRcmN" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_i9lf"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/carverauto/serviceradar" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_i9lf"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Carver Automation Corporation. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>